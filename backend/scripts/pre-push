#!/bin/bash
# pre-push hook - æ¨é€å‰æ£€æŸ¥åˆ†æ”¯å‘½åè§„èŒƒ

set -e

current_branch=$(git symbolic-ref --short HEAD)

echo "ğŸ” æ£€æŸ¥åˆ†æ”¯å‘½åè§„èŒƒ..."

# æ ‡å‡†æ ¼å¼æ£€æŸ¥
if echo "$current_branch" | grep -qE '^(feature|fix|refactor|test|docs|hotfix|release)/[a-z0-9-]+$'; then
    echo "âœ… åˆ†æ”¯å‘½åç¬¦åˆè§„èŒƒ: $current_branch"
    exit 0
fi

# ä¿æŠ¤åˆ†æ”¯æ£€æŸ¥
if echo "$current_branch" | grep -qE '^(main|develop|production)$'; then
    echo "âœ… ä¿æŠ¤åˆ†æ”¯: $current_branch"
    exit 0
fi

# ä¸ç¬¦åˆè§„èŒƒ
echo ""
echo "âŒ åˆ†æ”¯å‘½åä¸ç¬¦åˆè§„èŒƒ: $current_branch"
echo ""
echo "å…è®¸çš„æ ¼å¼ï¼š"
echo "  feature/xxx  - æ–°åŠŸèƒ½åˆ†æ”¯"
echo "  fix/xxx      - Bugä¿®å¤åˆ†æ”¯"
echo "  refactor/xxx - é‡æ„åˆ†æ”¯"
echo ""
echo "è·³è¿‡æ£€æŸ¥: git push --no-verify"
echo ""
exit 1
